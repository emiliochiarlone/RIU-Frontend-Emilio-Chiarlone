<div class="hero-list-container">
  <h2>Lista de Héroes</h2>
  <div class="hero-list-header">
    <mat-form-field appearance="outline" class="search-field">
      <mat-icon matPrefix aria-label="search icon">search</mat-icon>
      <mat-label>Buscar Héroe</mat-label>
      <input
        matInput
        [formControl]="searchControl"
        placeholder="Buscar por nombre"
        aria-label="search hero"
      />
      <mat-spinner matSuffix *ngIf="showSearchSpinner()" diameter="30"
      class="search-field-spinner"></mat-spinner>
    </mat-form-field>

    <button
      mat-raised-button
      color="primary"
      (click)="onAddClick()"
      class="add-hero-button"
    >
      + Añadir Héroe
    </button>
  </div>

  @defer {

    @if (heroDataSource.data.length > 0) {
    <span class="hero-count">{{ getHeroCountMessage() }}</span>
    <table mat-table [dataSource]="heroDataSource" class="heroes-table">
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>ID</th>
        <td mat-cell *matCellDef="let hero">{{ hero.id }}</td>
      </ng-container>
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Nombre</th>
        <td mat-cell *matCellDef="let hero">{{ hero.name }}</td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef >Acciones</th>
        <td mat-cell *matCellDef="let hero">
          <button mat-button (click)="onEditClick(hero.id)">
            Editar <mat-icon>edit</mat-icon>
          </button>
          <button mat-button (click)="onDeleteClick(hero.id)">
            Eliminar <mat-icon>delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    } @else {
    <div class="empty-results-container">
      <img
        class="empty-results-image"
        src="assets/img/no-results.png"
        alt="No heroes found"
      />
      No encontramos héroes con ese nombre.
    </div>
    }
  }

  @placeholder { Aquí se mostrará la tabla de heroes una vez cargada. }
  @error { Error al cargar la tabla. }

  @if ((storeLoading() || globalLoading()) && !showSearchSpinner()) {
    <app-loading-spinner></app-loading-spinner>
  }

  <div class="table-footer">
    <mat-paginator
      #heroPaginator
      [pageSize]="defaultPageSize"
      showFirstLastButtons
      aria-label="Select page"
      [hidePageSize]="true"
    ></mat-paginator>
  </div>
</div>
